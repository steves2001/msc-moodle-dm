Development Log

** 26/09/2014 **  V2014092602 Initial working version of the report shell

Created the shell file and folder structure for the moodle engagement report.

index.php  

Has basic requires for functionality but no restriction on who can access it

require_once('../../config.php');
require_once($CFG->libdir.'/adminlib.php');

There is basic code that generates the box around page in the current moodle theme

echo $OUTPUT->header();
echo $OUTPUT->heading("Hello World");
echo $OUTPUT->box_start();

echo $OUTPUT->box_end();
echo $OUTPUT->footer();

lib.php *BUG*

Code added to make the report appear in the navigation menu, currently this does not work further investigation required here!
https://docs.moodle.org/dev/Reports

function report_myreport_extend_navigation_course($navigation, $course, $context) {
    if (has_capability('report/engagement:view', $context)) {
        $url = new moodle_url('/report/engagement/index.php', array('id'=>$course->id));
        $navigation->add(get_string('pluginname', 'report_engagement'), $url, navigation_node::TYPE_SETTING, null, null, new pix_icon('i/report', ''));
    }
}


version.php

Code set to control the version of the plugin allowing moodle to upgrade
$plugin->version   = 2014092602;    // The current plugin version (Date: YYYYMMDDXX)
$plugin->requires  = 2013110500;    // Requires this Moodle version
$plugin->component = 'report_engagement';  // Full name of the plugin (used for diagnostics)


db/access.php

View restrictions structure is set up for the install and upgrade of the report 
https://docs.moodle.org/dev/NEWMODULE_Adding_capabilities

$capabilities = array(

    'report/engagement:view' => array(
        'riskbitmask' => RISK_PERSONAL,
        'captype' => 'read',
        'contextlevel' => CONTEXT_COURSE,
        'archetypes' => array(
            'teacher' => CAP_ALLOW,
            'editingteacher' => CAP_ALLOW,
            'manager' => CAP_ALLOW
        ),

        
    )
);